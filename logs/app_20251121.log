2025-11-21 15:43:05 - __main__ - INFO - ============================================================
2025-11-21 15:43:05 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-21 15:43:05 - __main__ - INFO - ============================================================
2025-11-21 15:43:05 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-21 15:43:05 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-21 15:43:06 - src.api.graph_client - ERROR - ✗ Authentication failed: 400 - {"error":"unauthorized_client","error_description":"AADSTS700016: Application with identifier '84dca025-5861-45cf-a607-8192db477417' was not found in the directory 'NEEVIQ TECHNOLOGIES PVT LTD'. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You may have sent your authentication request to the wrong tenant. Trace ID: d33320e4-ab02-4040-a2e9-a08e1db14700 Correlation ID: 7afdb0a6-c721-4325-8fe2-19f9f778ea3e Timestamp: 2025-11-21 10:13:06Z","error_codes":[700016],"timestamp":"2025-11-21 10:13:06Z","trace_id":"d33320e4-ab02-4040-a2e9-a08e1db14700","correlation_id":"7afdb0a6-c721-4325-8fe2-19f9f778ea3e","error_uri":"https://login.microsoftonline.com/error?code=700016"}
2025-11-21 15:43:06 - __main__ - ERROR - Authentication failed!
2025-11-21 15:43:06 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-21 15:45:07 - __main__ - INFO - ============================================================
2025-11-21 15:45:07 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-21 15:45:07 - __main__ - INFO - ============================================================
2025-11-21 15:45:07 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-21 15:45:07 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-21 15:45:08 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-21 16:45:07.861616
2025-11-21 15:45:08 - __main__ - INFO - ✓ Authentication successful!
2025-11-21 15:45:08 - __main__ - INFO - 
Testing API access by fetching user info...
2025-11-21 15:45:08 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:08 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:09","request-id":"46b0ee65-a714-4313-876e-a7f811758957","client-request-id":"46b0ee65-a714-4313-876e-a7f811758957"}}}
2025-11-21 15:45:08 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-21 15:45:08 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:09 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:09","request-id":"a4a767a4-234f-4dea-bbd5-0726b929e809","client-request-id":"a4a767a4-234f-4dea-bbd5-0726b929e809"}}}
2025-11-21 15:45:09 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-21 15:45:09 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:09 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:09","request-id":"af4be147-1126-4b44-abe8-a8ec2d894970","client-request-id":"af4be147-1126-4b44-abe8-a8ec2d894970"}}}
2025-11-21 15:45:09 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-21 15:45:09 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:09 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:09","request-id":"3bf79912-eac8-431a-9629-3c6c0b8b759a","client-request-id":"3bf79912-eac8-431a-9629-3c6c0b8b759a"}}}
2025-11-21 15:45:09 - __main__ - ERROR - ✗ Failed to fetch user info
2025-11-21 15:45:09 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-21 15:45:40 - __main__ - INFO - ============================================================
2025-11-21 15:45:40 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-21 15:45:40 - __main__ - INFO - ============================================================
2025-11-21 15:45:40 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-21 15:45:40 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-21 15:45:41 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-21 16:45:40.923573
2025-11-21 15:45:41 - __main__ - INFO - ✓ Authentication successful!
2025-11-21 15:45:41 - __main__ - INFO - 
Testing API access by fetching user info...
2025-11-21 15:45:41 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:42 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:42","request-id":"40812320-4bc5-404d-ab7e-45c0947614a7","client-request-id":"40812320-4bc5-404d-ab7e-45c0947614a7"}}}
2025-11-21 15:45:42 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-21 15:45:42 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:42 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:42","request-id":"a6642703-3b7d-4d1e-98b6-75da321244a9","client-request-id":"a6642703-3b7d-4d1e-98b6-75da321244a9"}}}
2025-11-21 15:45:42 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-21 15:45:42 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:42 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:42","request-id":"983c6c6f-6e0e-489f-9f9d-bc203691b54c","client-request-id":"983c6c6f-6e0e-489f-9f9d-bc203691b54c"}}}
2025-11-21 15:45:42 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-21 15:45:42 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me
2025-11-21 15:45:42 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-21T10:15:42","request-id":"2c447f43-cb27-4280-b866-e6e5f99b36dc","client-request-id":"2c447f43-cb27-4280-b866-e6e5f99b36dc"}}}
2025-11-21 15:45:42 - __main__ - ERROR - ✗ Failed to fetch user info
2025-11-21 15:45:42 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-21 15:49:18 - __main__ - INFO - ============================================================
2025-11-21 15:49:18 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-21 15:49:18 - __main__ - INFO - ============================================================
2025-11-21 15:49:18 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-21 15:49:18 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-21 15:49:19 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-21 16:49:18.080179
2025-11-21 15:49:19 - __main__ - INFO - ✓ Authentication successful!
2025-11-21 15:49:19 - __main__ - INFO - 
Testing API access by fetching organization info...
2025-11-21 15:49:19 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-21 15:49:20 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-21T10:19:21","request-id":"94e10d2b-0ee4-4498-b99b-b1c93d10f6fe","client-request-id":"94e10d2b-0ee4-4498-b99b-b1c93d10f6fe"}}}
2025-11-21 15:49:20 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-21 15:49:20 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-21 15:49:21 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-21T10:19:21","request-id":"870a55aa-605c-4289-a34f-5342fa212c09","client-request-id":"870a55aa-605c-4289-a34f-5342fa212c09"}}}
2025-11-21 15:49:21 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-21 15:49:21 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-21 15:49:23 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-21T10:19:23","request-id":"b0f6ca78-696d-43b2-a334-9cfd61c63fe8","client-request-id":"b0f6ca78-696d-43b2-a334-9cfd61c63fe8"}}}
2025-11-21 15:49:23 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-21 15:49:23 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-21 15:49:25 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-21T10:19:25","request-id":"22921744-08fb-4b81-bc07-18a6436f9785","client-request-id":"22921744-08fb-4b81-bc07-18a6436f9785"}}}
2025-11-21 15:49:25 - __main__ - ERROR - ✗ Failed to fetch organization info
2025-11-21 15:49:25 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
