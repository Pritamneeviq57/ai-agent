2025-11-24 10:27:21 - __main__ - INFO - ============================================================
2025-11-24 10:27:21 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-24 10:27:21 - __main__ - INFO - ============================================================
2025-11-24 10:27:21 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 10:27:21 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 10:27:21 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 11:27:20.851337
2025-11-24 10:27:21 - __main__ - INFO - ✓ Authentication successful!
2025-11-24 10:27:21 - __main__ - INFO - 
Testing API access by fetching organization info...
2025-11-24 10:27:21 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 10:27:22 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T04:57:22","request-id":"2d02cc2a-e1cd-46e1-a235-259b6740ed20","client-request-id":"2d02cc2a-e1cd-46e1-a235-259b6740ed20"}}}
2025-11-24 10:27:22 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-24 10:27:22 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 10:27:24 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T04:57:24","request-id":"d123efb3-b075-4002-bc38-47520b8a5a15","client-request-id":"d123efb3-b075-4002-bc38-47520b8a5a15"}}}
2025-11-24 10:27:24 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-24 10:27:24 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 10:27:25 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T04:57:25","request-id":"21e4cc6a-ef5f-48f5-8225-9a8a9ea17e12","client-request-id":"21e4cc6a-ef5f-48f5-8225-9a8a9ea17e12"}}}
2025-11-24 10:27:25 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-24 10:27:25 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 10:27:26 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T04:57:26","request-id":"4d4ecfd2-0fcd-4cc6-8d9d-25e3d4bf419f","client-request-id":"4d4ecfd2-0fcd-4cc6-8d9d-25e3d4bf419f"}}}
2025-11-24 10:27:26 - __main__ - ERROR - ✗ Failed to fetch organization info
2025-11-24 10:27:26 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-24 14:42:46 - __main__ - INFO - ============================================================
2025-11-24 14:42:46 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-24 14:42:46 - __main__ - INFO - ============================================================
2025-11-24 14:42:46 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 14:42:46 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 14:42:47 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 15:42:46.079456
2025-11-24 14:42:47 - __main__ - INFO - ✓ Authentication successful!
2025-11-24 14:42:47 - __main__ - INFO - 
Testing API access by fetching organization info...
2025-11-24 14:42:47 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:42:47 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:12:47","request-id":"4d7b4337-68af-4ee3-96b2-ff3a0ad0dc14","client-request-id":"4d7b4337-68af-4ee3-96b2-ff3a0ad0dc14"}}}
2025-11-24 14:42:47 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-24 14:42:47 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:42:47 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:12:48","request-id":"77463fdc-2150-4c42-bfa8-edbe0da743c3","client-request-id":"77463fdc-2150-4c42-bfa8-edbe0da743c3"}}}
2025-11-24 14:42:47 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-24 14:42:47 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:42:47 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:12:48","request-id":"89b2bb3d-37f9-46bd-8af1-b0e67ecacb5f","client-request-id":"89b2bb3d-37f9-46bd-8af1-b0e67ecacb5f"}}}
2025-11-24 14:42:47 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-24 14:42:47 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:42:47 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:12:48","request-id":"e25d206b-41e9-4d25-a54c-0b0b28a8779c","client-request-id":"e25d206b-41e9-4d25-a54c-0b0b28a8779c"}}}
2025-11-24 14:42:47 - __main__ - ERROR - ✗ Failed to fetch organization info
2025-11-24 14:42:47 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-24 14:43:01 - __main__ - INFO - ============================================================
2025-11-24 14:43:01 - __main__ - INFO - Testing Microsoft Graph API Authentication
2025-11-24 14:43:01 - __main__ - INFO - ============================================================
2025-11-24 14:43:01 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 14:43:01 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 14:43:01 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 15:43:00.292423
2025-11-24 14:43:01 - __main__ - INFO - ✓ Authentication successful!
2025-11-24 14:43:01 - __main__ - INFO - 
Testing API access by fetching organization info...
2025-11-24 14:43:01 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:43:01 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:13:02","request-id":"7b4a03a9-9292-4b15-b95f-d8d44e8a5a39","client-request-id":"7b4a03a9-9292-4b15-b95f-d8d44e8a5a39"}}}
2025-11-24 14:43:01 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-24 14:43:01 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:43:01 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:13:02","request-id":"dd2e7ff8-6e60-4f9a-93ea-b41980ece47a","client-request-id":"dd2e7ff8-6e60-4f9a-93ea-b41980ece47a"}}}
2025-11-24 14:43:01 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-24 14:43:01 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:43:02 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:13:02","request-id":"56357e81-7eb3-46ca-9f27-f9c028dd8636","client-request-id":"56357e81-7eb3-46ca-9f27-f9c028dd8636"}}}
2025-11-24 14:43:02 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-24 14:43:02 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/organization
2025-11-24 14:43:02 - src.api.graph_client - ERROR - HTTP Error 403: {"error":{"code":"Authorization_RequestDenied","message":"Insufficient privileges to complete the operation.","innerError":{"date":"2025-11-24T09:13:02","request-id":"34c2badb-fc51-4a82-86ab-f2852db655b5","client-request-id":"34c2badb-fc51-4a82-86ab-f2852db655b5"}}}
2025-11-24 14:43:02 - __main__ - ERROR - ✗ Failed to fetch organization info
2025-11-24 14:43:02 - __main__ - ERROR - 
✗ Tests failed. Check your credentials in .env file
2025-11-24 14:45:18 - __main__ - INFO - ============================================================
2025-11-24 14:45:18 - __main__ - INFO - Quick Authentication Test
2025-11-24 14:45:18 - __main__ - INFO - ============================================================
2025-11-24 14:45:18 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 14:45:18 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 14:45:20 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 15:45:19.015458
2025-11-24 14:45:20 - __main__ - INFO - ✅ Authentication successful!
2025-11-24 14:45:20 - __main__ - INFO - Token expires at: 2025-11-24 15:45:19.015458

2025-11-24 14:45:20 - __main__ - INFO - Test 1: Fetching call records (meetings)...
2025-11-24 14:45:20 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords?$top=1
2025-11-24 14:45:20 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"","message":"The query specified in the URI is not valid. Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","details":[],"innerError":{"message":"Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","date":"2025-11-24T09:15:21","request-id":"78101066-fd5d-4f81-8a74-ba2c3ad076e7","client-request-id":"78101066-fd5d-4f81-8a74-ba2c3ad076e7"}}}
2025-11-24 14:45:20 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-24 14:45:20 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords?$top=1
2025-11-24 14:45:21 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"","message":"The query specified in the URI is not valid. Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","details":[],"innerError":{"message":"Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","date":"2025-11-24T09:15:21","request-id":"2471cccf-491e-4fc5-aca6-b3f5d94e8815","client-request-id":"2471cccf-491e-4fc5-aca6-b3f5d94e8815"}}}
2025-11-24 14:45:21 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-24 14:45:21 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords?$top=1
2025-11-24 14:45:22 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"","message":"The query specified in the URI is not valid. Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","details":[],"innerError":{"message":"Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","date":"2025-11-24T09:15:22","request-id":"dcd86a48-e8e3-41ad-8971-35fa743b198e","client-request-id":"dcd86a48-e8e3-41ad-8971-35fa743b198e"}}}
2025-11-24 14:45:22 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-24 14:45:22 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords?$top=1
2025-11-24 14:45:22 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"","message":"The query specified in the URI is not valid. Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","details":[],"innerError":{"message":"Query option 'Top' is not allowed. To allow it, set the 'AllowedQueryOptions' property on EnableQueryAttribute or QueryValidationSettings.","date":"2025-11-24T09:15:23","request-id":"6978caa6-658e-4968-b7b8-b0eac2dc4aae","client-request-id":"6978caa6-658e-4968-b7b8-b0eac2dc4aae"}}}
2025-11-24 14:45:22 - __main__ - ERROR - ❌ FAILED - Check CallRecords.Read.All permission

2025-11-24 14:45:22 - __main__ - INFO - Test 2: Fetching online meetings...
2025-11-24 14:45:22 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me/onlineMeetings?$top=1
2025-11-24 14:45:23 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-24T09:15:23","request-id":"1a3e72ee-c831-42f6-984c-f58d61786662","client-request-id":"1a3e72ee-c831-42f6-984c-f58d61786662"}}}
2025-11-24 14:45:23 - src.api.graph_client - INFO - Retrying... (Attempt 1/3)
2025-11-24 14:45:23 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me/onlineMeetings?$top=1
2025-11-24 14:45:23 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-24T09:15:24","request-id":"baf88ed5-5436-4a5f-ac28-8d1a63c3e2b3","client-request-id":"baf88ed5-5436-4a5f-ac28-8d1a63c3e2b3"}}}
2025-11-24 14:45:23 - src.api.graph_client - INFO - Retrying... (Attempt 2/3)
2025-11-24 14:45:23 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me/onlineMeetings?$top=1
2025-11-24 14:45:24 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-24T09:15:24","request-id":"5eef1b1a-591c-45e4-bf2c-6d785fac239c","client-request-id":"5eef1b1a-591c-45e4-bf2c-6d785fac239c"}}}
2025-11-24 14:45:24 - src.api.graph_client - INFO - Retrying... (Attempt 3/3)
2025-11-24 14:45:24 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/me/onlineMeetings?$top=1
2025-11-24 14:45:24 - src.api.graph_client - ERROR - HTTP Error 400: {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-11-24T09:15:25","request-id":"b5c20d66-820a-4d75-976d-905a0d0cae81","client-request-id":"b5c20d66-820a-4d75-976d-905a0d0cae81"}}}
2025-11-24 14:45:24 - __main__ - ERROR - ❌ FAILED - This uses delegated auth (requires user context)

2025-11-24 14:45:24 - __main__ - INFO - ============================================================
2025-11-24 14:45:24 - __main__ - INFO - Authentication & Permissions Check Complete
2025-11-24 14:45:24 - __main__ - INFO - ============================================================
2025-11-24 14:56:26 - __main__ - INFO - ============================================================
2025-11-24 14:56:26 - __main__ - INFO - Quick Authentication Test
2025-11-24 14:56:26 - __main__ - INFO - ============================================================
2025-11-24 14:56:26 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 14:56:26 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 14:56:27 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 15:56:26.166294
2025-11-24 14:56:27 - __main__ - INFO - ✅ Authentication successful!
2025-11-24 14:56:27 - __main__ - INFO - Token expires at: 2025-11-24 15:56:26.166294

2025-11-24 14:56:27 - __main__ - INFO - Test 1: Fetching call records (meetings) from last 7 days...
2025-11-24 14:56:27 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords
2025-11-24 14:56:27 - __main__ - INFO - ✅ SUCCESS - Found 60 call records

2025-11-24 14:56:27 - __main__ - INFO - ✅ Phase 2.1 Complete - Authentication & Permissions Working!
2025-11-24 14:56:27 - __main__ - INFO - Ready for Phase 2.2 - Fetch 15 Days Meeting List
2025-11-24 15:00:39 - __main__ - INFO - 

2025-11-24 15:00:39 - __main__ - INFO - ============================================================
2025-11-24 15:00:39 - __main__ - INFO - Phase 2.1 - Microsoft Graph API Integration
2025-11-24 15:00:39 - __main__ - INFO - ============================================================
2025-11-24 15:00:39 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 15:00:39 - __main__ - INFO - 
[Step 1] Authenticating with Azure AD...
2025-11-24 15:00:39 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 15:00:41 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 16:00:40.261908
2025-11-24 15:00:41 - __main__ - INFO - ✅ Authentication successful!
2025-11-24 15:00:41 - __main__ - INFO -    Token expires at: 2025-11-24 16:00:40.261908
2025-11-24 15:00:41 - __main__ - INFO - 
[Step 2] Testing API access by fetching call records...
2025-11-24 15:00:41 - __main__ - INFO -    Endpoint: GET /communications/callRecords
2025-11-24 15:00:41 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords
2025-11-24 15:00:42 - __main__ - INFO - ✅ API access successful!
2025-11-24 15:00:42 - __main__ - INFO -    Found 60 call records from last 7 days
2025-11-24 15:00:42 - __main__ - INFO - 
   Sample Meeting Data:
2025-11-24 15:00:42 - __main__ - INFO -    - Meeting ID: 07826f51-413d-4b16-9623-6b65c0ceeb11
2025-11-24 15:00:42 - __main__ - INFO -    - Start: 2025-11-24T05:52:21.9851609Z
2025-11-24 15:00:42 - __main__ - INFO -    - End: 2025-11-24T05:52:22.2350371Z
2025-11-24 15:00:42 - __main__ - INFO -    - Organizer: Shivani Ardad
2025-11-24 15:00:42 - __main__ - INFO - 
============================================================
2025-11-24 15:00:42 - __main__ - INFO - ✅ Phase 2.1 COMPLETE - Authentication & API Integration Working!
2025-11-24 15:00:42 - __main__ - INFO - ✅ You can now fetch Teams meetings from Microsoft Graph API
2025-11-24 15:00:42 - __main__ - INFO - ============================================================
2025-11-24 15:01:01 - __main__ - INFO - 

2025-11-24 15:01:01 - __main__ - INFO - ============================================================
2025-11-24 15:01:01 - __main__ - INFO - Phase 2.1 - Microsoft Graph API Integration
2025-11-24 15:01:01 - __main__ - INFO - ============================================================
2025-11-24 15:01:01 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 15:01:01 - __main__ - INFO - 
[Step 1] Authenticating with Azure AD...
2025-11-24 15:01:01 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 15:01:02 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 16:01:01.665830
2025-11-24 15:01:02 - __main__ - INFO - ✅ Authentication successful!
2025-11-24 15:01:02 - __main__ - INFO -    Token expires at: 2025-11-24 16:01:01.665830
2025-11-24 15:01:02 - __main__ - INFO - 
[Step 2] Testing API access by fetching call records...
2025-11-24 15:01:02 - __main__ - INFO -    Endpoint: GET /communications/callRecords
2025-11-24 15:01:02 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords
2025-11-24 15:01:03 - __main__ - INFO - ✅ API access successful!
2025-11-24 15:01:03 - __main__ - INFO -    Found 60 call records from last 7 days
2025-11-24 15:01:03 - __main__ - INFO - 
   Sample Meeting Data:
2025-11-24 15:01:03 - __main__ - INFO -    - Meeting ID: 07826f51-413d-4b16-9623-6b65c0ceeb11
2025-11-24 15:01:03 - __main__ - INFO -    - Start: 2025-11-24T05:52:21.9851609Z
2025-11-24 15:01:03 - __main__ - INFO -    - End: 2025-11-24T05:52:22.2350371Z
2025-11-24 15:01:03 - __main__ - INFO -    - Organizer: Shivani Ardad
2025-11-24 15:01:03 - __main__ - INFO - 
============================================================
2025-11-24 15:01:03 - __main__ - INFO - ✅ Phase 2.1 COMPLETE - Authentication & API Integration Working!
2025-11-24 15:01:03 - __main__ - INFO - ✅ You can now fetch Teams meetings from Microsoft Graph API
2025-11-24 15:01:03 - __main__ - INFO - ============================================================
2025-11-24 17:45:59 - __main__ - INFO - 

2025-11-24 17:45:59 - __main__ - INFO - ============================================================
2025-11-24 17:45:59 - __main__ - INFO - Phase 2.1 - Microsoft Graph API Integration
2025-11-24 17:45:59 - __main__ - INFO - ============================================================
2025-11-24 17:45:59 - src.api.graph_client - INFO - GraphAPIClient initialized
2025-11-24 17:45:59 - __main__ - INFO - 
[Step 1] Authenticating with Azure AD...
2025-11-24 17:45:59 - src.api.graph_client - INFO - Starting authentication with Azure AD...
2025-11-24 17:46:01 - src.api.graph_client - INFO - ✓ Authentication successful! Token expires at: 2025-11-24 18:46:00.174211
2025-11-24 17:46:01 - __main__ - INFO - ✅ Authentication successful!
2025-11-24 17:46:01 - __main__ - INFO -    Token expires at: 2025-11-24 18:46:00.174211
2025-11-24 17:46:01 - __main__ - INFO - 
[Step 2] Testing API access by fetching call records...
2025-11-24 17:46:01 - __main__ - INFO -    Endpoint: GET /communications/callRecords
2025-11-24 17:46:01 - src.api.graph_client - DEBUG - Making GET request to: https://graph.microsoft.com/v1.0/communications/callRecords
2025-11-24 17:46:02 - __main__ - INFO - ✅ API access successful!
2025-11-24 17:46:02 - __main__ - INFO -    Found 60 call records from last 7 days
2025-11-24 17:46:02 - __main__ - INFO - 
   Sample Meeting Data:
2025-11-24 17:46:02 - __main__ - INFO -    - Meeting ID: 0681bb13-94db-479d-9d4a-9414f86803cb
2025-11-24 17:46:02 - __main__ - INFO -    - Start: 2025-11-24T10:24:36.5825899Z
2025-11-24 17:46:02 - __main__ - INFO -    - End: 2025-11-24T10:35:27.9488928Z
2025-11-24 17:46:02 - __main__ - INFO -    - Organizer: Shivani Bankar
2025-11-24 17:46:02 - __main__ - INFO - 
============================================================
2025-11-24 17:46:02 - __main__ - INFO - ✅ Phase 2.1 COMPLETE - Authentication & API Integration Working!
2025-11-24 17:46:02 - __main__ - INFO - ✅ You can now fetch Teams meetings from Microsoft Graph API
2025-11-24 17:46:02 - __main__ - INFO - ============================================================
